# -*- coding: utf-8 -*-
"""
使用说明文本模块：包含各功能模块的详细使用指南。
"""

HELP_TEXTS = {
    "视频压制": """
【视频压制】视频转码、压缩和字幕烧录

━━━━━━━━━━ 基本使用 ━━━━━━━━━━
1. 选择输入视频文件
2. 选择质量预设
3. 可选：添加字幕文件
4. 点击"开始"

━━━━━━━━━━ 质量预设 ━━━━━━━━━━
【均衡画质】x264 CRF18 / medium
  适合 B 站投稿，画质与体积均衡
  
【极致画质】x264 CRF16 / slow
  高码率慢速编码，适合 AMV

【速度优先】NVENC CQ23 / p4
  NVIDIA 显卡加速，适合赶稿
  
【画质优先 HQ】NVENC CQ19 / p7
  N 卡高画质，使用 VBR 动态码率

【自定义】手动配置所有参数

━━━━━━━━━━ 编码器设置 ━━━━━━━━━━
• 编码器: CPU/NVIDIA/Intel/AMD
• 编码速度: ultrafast → veryslow
• N卡速度档位: p1(最快) → p7(最慢)
  ※ 选择 NVENC 编码器时生效

━━━━━━━━━━ 码率控制 ━━━━━━━━━━
• CRF/CQ: 恒定质量 (推荐)
• VBR: 可变码率
• CBR: 恒定码率，适合推流
• 2-Pass: 两遍编码，精确控制

━━━━━━━━━━ 字幕兼容模式 ━━━━━━━━━━
字体显示异常时勾选"兼容模式":
• 使用 AviSynth + VSFilter 渲染
• 调用 Windows GDI 字体引擎
• 无需安装 AviSynth，解压即用

━━━━━━━━━━ 高级选项 ━━━━━━━━━━
• Debug 模式: 仅输出命令，不执行

⚠️ 字幕烧录需重编码，无法使用 copy
""",
    
    "音频替换": """
【音频替换】替换视频中的音轨

━━━━━━━━━━ 基本使用 ━━━━━━━━━━
1. 选择原始视频文件
2. 选择新的音频文件
3. 选择音频编码器和码率
4. 点击"开始"

━━━━━━━━━━ 适用场景 ━━━━━━━━━━
• 替换 BGM
• 修复音频问题
• 添加配音/解说

⚠️ 视频流自动复制，不重新编码
⚠️ 新音频时长建议与视频一致
""",
    
    "封装转换": """
【封装转换】更换容器格式，不重新编码

━━━━━━━━━━ 基本使用 ━━━━━━━━━━
1. 选择输入文件 (可批量多选)
2. 选择目标封装格式
3. 点击"开始"

━━━━━━━━━━ 格式预设 ━━━━━━━━━━
• MP4: 最广泛兼容
• MKV: 多音轨多字幕
• MOV: Apple 生态
• TS: 广播传输流
• WEBM: 网页播放
• MXF: 专业后期

⚠️ 不重新编码，速度极快
⚠️ 某些编码不兼容某些容器
""",
    
    "素材质量检测": """
【素材质量检测】批量检测素材兼容性

━━━━━━━━━━ 基本使用 ━━━━━━━━━━
1. 选择要扫描的目录
2. 设置检测阈值 (可选)
3. 开启兼容性检测选项
4. 点击"开始"

━━━━━━━━━━ 检测内容 ━━━━━━━━━━
• 码率/分辨率范围检测
• 容器兼容性 (MKV/WEBM/FLV)
• 编码兼容性 (VP9/AV1/Theora)
• 图片格式检测 (WEBP 等)

━━━━━━━━━━ 自定义规则 ━━━━━━━━━━
用逗号分隔格式:
• 容器: mkv,webm,flv
• 编码: vp9,av1,theora
• 图片: webp,jxl

扫描完成后生成 TXT 报告。
""",
    
    "音频抽取": """
【音频抽取】从视频中提取音频轨道

━━━━━━━━━━ 基本使用 ━━━━━━━━━━
1. 选择输入视频
2. 选择音频编码器
3. 点击"开始"

━━━━━━━━━━ 编码器 ━━━━━━━━━━
• AAC: 推荐，兼容性好
• MP3: 通用格式
• WAV: 无损但文件大
• FLAC: 无损压缩
• 复制: 无损提取原始音频

⚠️ "复制"输出格式取决于原始编码
""",
    
    "通知设置": """
【通知设置】任务完成后自动通知

━━━━━━━━━━ 基本使用 ━━━━━━━━━━
1. 配置飞书或自定义 Webhook
2. 勾选"启用自动通知"
3. 执行其他任务时自动发送通知

━━━━━━━━━━ 飞书通知 ━━━━━━━━━━
1. 在飞书群添加自定义机器人
2. 粘贴 Webhook URL
3. 填写标题和内容
4. 选择卡片颜色

━━━━━━━━━━ 自定义 Webhook ━━━━━━━━━━
支持任意 POST 请求:
• URL: Webhook 地址
• Headers: JSON 格式
• Body: JSON 格式

点击"开始"可测试通知。
""",
    
    "常见问题": """
【常见问题 FAQ】

❓ 找不到 FFmpeg？
→ 工具按顺序查找: 程序目录/bin → 系统 PATH

❓ 压制后文件比原来还大？
→ 提高 CRF 值 (23-28) 或降低分辨率

❓ PR 导入视频有问题？
→ 使用"素材质量检测"后"封装转换"

❓ 字幕没有出现？
→ 检查: 路径无特殊字符、UTF-8 编码

❓ NVIDIA 加速不生效？
→ 安装最新显卡驱动，确认 NVENC 支持

❓ 字幕字体显示异常？
→ 勾选"兼容模式 (字幕)"

❓ 没收到任务通知？
→ 确认"启用自动通知"已勾选
""",

    "图片转换": """
【图片转换】批量转换图片格式

━━━━━━━━━━ 基本使用 ━━━━━━━━━━
1. 选择图片文件 (可多选)
2. 选择目标格式
3. 可选：指定输出目录
4. 点击"开始"

━━━━━━━━━━ 支持格式 ━━━━━━━━━━
• PNG: 无损，支持透明
• JPG: 有损压缩，体积小
• WEBP: 压缩率高
• BMP/GIF/TIFF

━━━━━━━━━━ 质量设置 ━━━━━━━━━━
仅 JPG/WEBP 有效，1-100
推荐值: 90-95

⚠️ 转 JPG 时透明背景变白色
""",

    "文件夹创建": """
【文件夹创建】从 TXT 批量创建文件夹

━━━━━━━━━━ 基本使用 ━━━━━━━━━━
1. 准备 TXT 文件，每行一个名称
2. 选择该 TXT 文件
3. 选择输出目录
4. 点击"开始"

━━━━━━━━━━ 自动排序 ━━━━━━━━━━
开启后自动添加序号:
1_文件夹A → 2_文件夹B → 3_文件夹C

━━━━━━━━━━ 非法字符 ━━━━━━━━━━
自动替换: \\ / : * ? " < > |

支持 UTF-8/GBK/UTF-16 编码
""",

    "批量重命名": """
【批量重命名】序列重命名图片/视频

━━━━━━━━━━ 基本使用 ━━━━━━━━━━
1. 选择输入目录
2. 设置重命名模式
3. 选择目标文件类型
4. 点击"开始"

━━━━━━━━━━ 重命名模式 ━━━━━━━━━━
• 原地重命名
• 复制并重命名
• 移动并重命名

━━━━━━━━━━ 行为模式 ━━━━━━━━━━
递归: 处理所有子文件夹
  格式: 父文件夹_图片_1.后缀
  
非递归: 仅处理指定目录
  格式: 图片_1.后缀

文件按大小排序后编号。
""",
}


def get_help_text(topic: str) -> str:
    """
    获取指定功能的使用说明文本。
    
    Args:
        topic: 功能名称
        
    Returns:
        使用说明文本
    """
    return HELP_TEXTS.get(topic, "暂无此功能的说明。")
